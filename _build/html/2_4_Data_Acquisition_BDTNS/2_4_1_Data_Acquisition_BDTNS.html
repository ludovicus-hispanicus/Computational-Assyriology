
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2.4.1 Data Acquision BDTNS &#8212; Computational Assyriology</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.4.2 Build Sign Search for BDTNS" href="2_4_2_Build_Sign_Search.html" />
    <link rel="prev" title="2.4 BDTNS" href="2_4_0_Data_Acquisition_BDTNS.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Computational Assyriology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Computational Assyriology
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Preliminaries/1_Introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../2_Data_Acquisition/2_Data_Acquisition.html">
   2 Data Acquisition
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../2_1_Data_Acquisition_ORACC/2_1_Data_Acquisition.html">
     2.1 Data Acquisition: ORACC
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../2_1_Data_Acquisition_ORACC/2_1_0_download_ORACC-JSON.html">
       2.1.0 Download ORACC JSON Files
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../2_1_Data_Acquisition_ORACC/2_1_1_JSON.html">
       2.1.1 The JSON Data Format
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../2_1_Data_Acquisition_ORACC/2_1_2_parse-json-cat.html">
       2.1.2 Retrieve ORACC Catalog Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../2_1_Data_Acquisition_ORACC/2_1_3_basic_ORACC-JSON_parser.html">
       2.1.3 Extract Lemmatization from ORACC JSON: Basic Parser
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../2_1_Data_Acquisition_ORACC/2_1_4_extended_ORACC-JSON_parser.html">
       2.1.4 ORACC JSON: Extended Parser
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_2_Data_Acquisition_ETCSL/2_2_Data_Acquisition_ETCSL.html">
     2.2 Data Acquisition ETCSL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_3_Data_Acquisition_CDLI/2_3_Data_Acquisition_CDLI.html">
     2.3 Data Acquisition from CDLI
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="2_4_0_Data_Acquisition_BDTNS.html">
     2.4 BDTNS
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       2.4.1 Data Acquision BDTNS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="2_4_2_Build_Sign_Search.html">
       2.4.2 Build Sign Search for BDTNS
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_Vocabularies/3_Lexical_and_Literary_Vocabularies.html">
   3. Lexical and Literary Vocabularies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_Vocabularies/3_1_Lit_Lex_Vocab.html">
   3 Overlap in Lexical and Literary Vocabulary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_Vocabularies/3_2_Lit_Lex.html">
   3.2 Overlap in Lexical and Literary Vocabulary: Digging Deeper
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_Vocabularies/3_3_Lex-Lit.html">
   3.3 Lexical Texts and their Relation to Literary Vocabulary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_Vocabularies/3_4_Admin_Lex_Vocab.html">
   3.4 Overlap in Lexical and Admin Vocabulary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4_Networking_Treasure_Archive/4_1_Build-Treasure-network.html">
   Social Network: The Treasure And Shoe Archive from Drehem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4_Networking_Treasure_Archive/4_2_Analyze_Visualize.html">
   Visualization Functions
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/niekveldhuis/compass/master?urlpath=tree/2_4_Data_Acquisition_BDTNS/2_4_1_Data_Acquisition_BDTNS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/niekveldhuis/compass/blob/master/2_4_Data_Acquisition_BDTNS/2_4_1_Data_Acquisition_BDTNS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/2_4_Data_Acquisition_BDTNS/2_4_1_Data_Acquisition_BDTNS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages-and-create-directory">
   2.4.1.0 Import Packages and create directory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-bdtns-data-files">
   2.4.1.1 Get BDTNS Data Files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bdtns-catalog">
   2.4.1.2 BDTNS Catalog
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bdtns-transliterations">
   2.4.1.3 BDTNS Transliterations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-the-transliteration-file-as-a-list">
     2.4.1.3.1 Read the Transliteration File as a List
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-data-into-fields">
     2.4.1.3.2 Split Data into Fields
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dataframe">
     2.4.1.3.3 Create DataFrame
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-ogsl-compliant">
   2.4.1.4 Make OGSL compliant
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dealing-with-x-values">
     2.4.1.4.1 Dealing with x-values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-unambiguous-x-values">
     2.4.1.4.2 Step 1: Unambiguous x-values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-remaining-x-values">
     2.4.1.4.3 Step 2: Remaining x-values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-index-numbers">
     2.4.1.4.4 Step 3: Index Numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#errors">
     2.4.1.4.5 Errors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#helpful-variables-lists-and-dictionaries">
     2.4.1.4.6 Helpful Variables, Lists, and Dictionaries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-main-function">
     2.4.1.4.7 The Main Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#apply-the-function">
     2.4.1.4.8 Apply the Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-for-remaining-x-signs">
     2.4.1.4.9 Check for Remaining X-signs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save">
   2.4.1.5 Save
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pickle-for-future-use">
     2.4.1.5.1 Pickle for Future Use
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dump-in-json-format-for-distribution">
     2.4.1.5.2 Dump in JSON Format for Distribution
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>2.4.1 Data Acquision BDTNS</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages-and-create-directory">
   2.4.1.0 Import Packages and create directory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-bdtns-data-files">
   2.4.1.1 Get BDTNS Data Files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bdtns-catalog">
   2.4.1.2 BDTNS Catalog
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bdtns-transliterations">
   2.4.1.3 BDTNS Transliterations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-the-transliteration-file-as-a-list">
     2.4.1.3.1 Read the Transliteration File as a List
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-data-into-fields">
     2.4.1.3.2 Split Data into Fields
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dataframe">
     2.4.1.3.3 Create DataFrame
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-ogsl-compliant">
   2.4.1.4 Make OGSL compliant
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dealing-with-x-values">
     2.4.1.4.1 Dealing with x-values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-unambiguous-x-values">
     2.4.1.4.2 Step 1: Unambiguous x-values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-remaining-x-values">
     2.4.1.4.3 Step 2: Remaining x-values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-index-numbers">
     2.4.1.4.4 Step 3: Index Numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#errors">
     2.4.1.4.5 Errors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#helpful-variables-lists-and-dictionaries">
     2.4.1.4.6 Helpful Variables, Lists, and Dictionaries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-main-function">
     2.4.1.4.7 The Main Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#apply-the-function">
     2.4.1.4.8 Apply the Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-for-remaining-x-signs">
     2.4.1.4.9 Check for Remaining X-signs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save">
   2.4.1.5 Save
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pickle-for-future-use">
     2.4.1.5.1 Pickle for Future Use
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dump-in-json-format-for-distribution">
     2.4.1.5.2 Dump in JSON Format for Distribution
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="data-acquision-bdtns">
<span id="id1"></span><h1>2.4.1 Data Acquision BDTNS<a class="headerlink" href="#data-acquision-bdtns" title="Permalink to this headline">#</a></h1>
<p>Goal of this notebook is to transform <a class="reference external" href="http://bdtns.filol.csic.es/">BDTNS</a> data into a structured format that clearly distinguishes between text and non-text (such as line numbers) and that, for the text part, follows as much as possible the standards of the Oracc Global Sign List (<a class="reference external" href="http://oracc.org/ogsl">OGSL</a>). In section <a class="reference internal" href="2_4_2_Build_Sign_Search.html#id1"><span class="std std-ref">2.4.2</span></a> we will use this structured data to build a search engine that is independent of sign readings (that is, searching for <strong>sukkal</strong>, <strong>sugal₇</strong> or <strong>luh</strong> will all yield the same results). The search engine will serve as an example of the potential power of mashing two independent projects.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>A similar search engine was developed by Marc Endesfelder for his <a class="reference external" href="https://corpus.writing-sumerian.assyriologie.uni-muenchen.de/">Writing Sumerian</a> project.</p>
</aside>
<section id="import-packages-and-create-directory">
<h2>2.4.1.0 Import Packages and create directory<a class="headerlink" href="#import-packages-and-create-directory" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>requests: for communicating with a server over the internet</p></li>
<li><p>pandas: data analysis and manipulation; dataframes</p></li>
<li><p>re: Regular Expressions</p></li>
<li><p>tqdm: progress bar</p></li>
<li><p>os: basic Operating System tasks (such as creating a directory)</p></li>
<li><p>sys: change system parameters</p></li>
<li><p>pickle: save data for future use</p></li>
<li><p>zipfile: read data from a zipped file</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">tqdm.auto</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="n">tqdm</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span> <span class="c1"># initiate pandas support in tqdm, allowing progress_apply() and progress_map()</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">exist_ok</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-bdtns-data-files">
<h2>2.4.1.1 Get BDTNS Data Files<a class="headerlink" href="#get-bdtns-data-files" title="Permalink to this headline">#</a></h2>
<p>For the time being, the data are downloaded in Zipped format from the <a class="reference external" href="https://github.com/niekveldhuis/compass">Compass</a> repository.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.github.com/niekveldhuis/compass/master/BDTNS_data/BDTNS.zip&quot;</span>
<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;../BDTNS_data/BDTNS.zip&quot;</span>
<span class="n">CHUNK</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>   <span class="c1"># meaning that the file exists</span>
        <span class="n">total_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-length&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">tqdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saving </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1"> as </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">=</span><span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total_size</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">unit_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;BDTNS&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="n">CHUNK</span><span class="p">):</span>
                <span class="n">t</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tqdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saving https://raw.github.com/niekveldhuis/compass/master/BDTNS_data/BDTNS.zip as ../BDTNS_data/BDTNS.zip
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "02af11c50ebc4b6ab1320ac842f1db3f", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="bdtns-catalog">
<h2>2.4.1.2 BDTNS Catalog<a class="headerlink" href="#bdtns-catalog" title="Permalink to this headline">#</a></h2>
<p>Extract the files from the ZIP and transform the catalog file into a Pandas data frame.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Inspect the catalog to see if the column names correspond to the actual contents. Different versions of the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> catalog may have different selections of fields and/or may present those fields in a different order. Adjust the variable <code class="docutils literal notranslate"><span class="pre">cols</span></code>, if necessary.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;../BDTNS_data/BDTNS.zip&quot;</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_file</span><span class="p">:</span>
    <span class="n">zip_file</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s2">&quot;../BDTNS_data&quot;</span><span class="p">)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="s2">&quot;../BDTNS_data/QUERY_catalogue.txt&quot;</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_text&#39;</span><span class="p">,</span> <span class="s1">&#39;cdli&#39;</span><span class="p">,</span> <span class="s1">&#39;publication&#39;</span><span class="p">,</span> <span class="s1">&#39;mus_no&#39;</span><span class="p">,</span>
        <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;provenance&#39;</span><span class="p">]</span>
<span class="n">cat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span> <span class="n">cols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">cat_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>cdli</th>
      <th>publication</th>
      <th>mus_no</th>
      <th>date</th>
      <th>provenance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>197624</td>
      <td></td>
      <td>À l'école des scribes, p. 104</td>
      <td></td>
      <td>AS09 - 00 - 00</td>
      <td>Umma</td>
    </tr>
    <tr>
      <th>1</th>
      <td>203551</td>
      <td></td>
      <td>A New Cuneiform Text..., IM 141866</td>
      <td>IM 141866 //</td>
      <td>0000 - 00 - 00</td>
      <td>Umma</td>
    </tr>
    <tr>
      <th>2</th>
      <td>021035</td>
      <td>P114469</td>
      <td>AAA 1 78 24 = MVN 05 249 = CDLI P114469</td>
      <td>WML 49.47.46</td>
      <td>0000 - 07 - 12</td>
      <td>Ĝirsu</td>
    </tr>
    <tr>
      <th>3</th>
      <td>038568</td>
      <td>P142651</td>
      <td>AAICAB 1/1, Ashm. 1909-951 = CDLI P142651</td>
      <td>Ashm. 1909-951</td>
      <td>AS05 - 11 - 00</td>
      <td>Ĝirsu</td>
    </tr>
    <tr>
      <th>4</th>
      <td>038569</td>
      <td>P142652</td>
      <td>AAICAB 1/1, Ashm. 1911-139 = CDLI P142652</td>
      <td>Ashm. 1911-139</td>
      <td>SS09 - 08 - 23</td>
      <td>Umma</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>101385</th>
      <td>006022</td>
      <td>P142619</td>
      <td>ZVO 25 134 2 = Hermitage 3 195 (unpubl.) = CDL...</td>
      <td>Erm 14814</td>
      <td>AS01 - 03 - 28</td>
      <td>Puzriš-Dagān</td>
    </tr>
    <tr>
      <th>101386</th>
      <td>006023</td>
      <td>P142620</td>
      <td>ZVO 25 136 3 = RA 73 190 = RIM E3/2.1.2.74</td>
      <td>MA 9612</td>
      <td>AS06 - 00 - 00</td>
      <td>Umma</td>
    </tr>
    <tr>
      <th>101387</th>
      <td>191925</td>
      <td></td>
      <td>Zwischen Orient und Okzident 262 1</td>
      <td></td>
      <td>AS03 - 00 - 00</td>
      <td>Umma</td>
    </tr>
    <tr>
      <th>101388</th>
      <td>191926</td>
      <td></td>
      <td>Zwischen Orient und Okzident 264 2</td>
      <td></td>
      <td>IS01 - 00 - 00</td>
      <td>Umma</td>
    </tr>
    <tr>
      <th>101389</th>
      <td>170094</td>
      <td>P253713</td>
      <td></td>
      <td>MS 4703</td>
      <td></td>
      <td>Unkn. Prov.</td>
    </tr>
  </tbody>
</table>
<p>101390 rows × 6 columns</p>
</div></div></div>
</div>
<p>The catalog DataFrame is not used further in this notebook, but will be used in the search engine in <a class="reference internal" href="2_4_2_Build_Sign_Search.html#id1"><span class="std std-ref">2.4.2</span></a>. For now it is saved as a file with the <code class="docutils literal notranslate"><span class="pre">pickle</span></code> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pickled</span> <span class="o">=</span> <span class="s2">&quot;output/bdtns_cat.p&quot;</span>
<span class="n">cat_df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">pickled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="bdtns-transliterations">
<h2>2.4.1.3 BDTNS Transliterations<a class="headerlink" href="#bdtns-transliterations" title="Permalink to this headline">#</a></h2>
<section id="read-the-transliteration-file-as-a-list">
<h3>2.4.1.3.1 Read the Transliteration File as a List<a class="headerlink" href="#read-the-transliteration-file-as-a-list" title="Permalink to this headline">#</a></h3>
<p>The transliteration file is already extracted from the file BDTNS.zip and is located in the directory <code class="docutils literal notranslate"><span class="pre">../BDTNS_data/</span></code>.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">utf-8, utf-8-sig, vertical tabs</p>
<p>If the first line of the output begins with “\ufeff” (the Byte Order Mark, or BOM), check that the encoding is set to “utf-8-sig” (not “utf-8”). In some of its output files <a class="reference external" href="http://bdtns.filol.csic.es/">BDTNS</a> uses so-called “vertical tabs” (represented by <code class="docutils literal notranslate"><span class="pre">^K</span></code>, <code class="docutils literal notranslate"><span class="pre">\v</span></code>, or <code class="docutils literal notranslate"><span class="pre">\x0b</span></code>, depending on your editor).  These “vertical TABS” are inserted between lines that belong to the same document; the regular newline character is used to separate one document from the next. If that is the case adjust the line</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bdtns</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
<p>to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bdtns</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.splitlines()</span></code> method takes both the vertical tab and the regular newline character as a line separator. The <code class="docutils literal notranslate"><span class="pre">.read()</span></code> method puts the entire file in memory and is therefore less efficient - if possible, use the <code class="docutils literal notranslate"><span class="pre">.readlines()</span></code> method.</p>
</div>
<p>Empty lines and lines filled with spaces or tabs only will cause trouble downstream and are removed. Also removed are lines that consist of sequences of ‘=’ signs (those are used to demarcate one document from the next).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;../BDTNS_data/QUERY_transliterations.txt&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">bdtns</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">bdtns</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">bdtns</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="c1"># remove empty lines and lines consisting of &#39;=&#39; signs only</span>
<span class="n">bdtns</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span> <span class="c1"># inspect the results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&quot;197624\tÀ l&#39;école des scribes, p. 104\t\n&quot;,
 &#39;203551\tA New Cuneiform Text..., IM 141866\t\n&#39;,
 &#39;o. 1     1 nu-dib Lugal-⌈x⌉ [...]\n&#39;,
 &#39;o. 2     1 nu-dib A-a-kal-la dum[u ...] / AN? [...]\n&#39;,
 &#39;o. 3     1 nu-dib Lu2-{d}Šara2 [dumu] / Lugal-{d}Iš[taran?] (= K[A.DI?])\n&#39;,
 &#39;o. 4     --- Lu2-Ib-gal dumu Ur-⌈x⌉-[...] # (1 nu-dib erased)\n&#39;,
 &#39;o. 5     1 nu-dib Lu2-uru-bar-ra dumu ⌈Nam⌉-ha-ni / sagi\n&#39;,
 &#39;o. 6     1 nu-dib Lu2-kiri3-zal dumu / Ur-nigarX{gar}\n&#39;,
 &#39;o. 7     1 nu-dib Lugal-inim-ge-na dumu / Ur-{giš}gigir a-IL2\n&#39;,
 &#39;o. 8     ------------\n&#39;,
 &#39;o. 9     giri3-se3-ga {d}Šara2 Umma{ki}-/me-eš2\n&#39;,
 &#39;r.      ============\n&#39;,
 &#39;021035\tAAA 1 78 24 = MVN 05 249 = CDLI P114469\t\n&#39;,
 &#39;o. 1     5 sila3 kaš 3 sila3 zi3\n&#39;,
 &#39;o. 2     1 i3 a2-GAM\n&#39;,
 &#39;o. 3     Lu2-Ma2-gan-na lu2-{giš}tukul-gu-&lt;la&gt;\n&#39;,
 &#39;o. 4     0.0.1 kaš 5 sila3 zi3\n&#39;,
 &#39;o. 5     1 i3 a2-GAM\n&#39;,
 &#39;o. 6     da-da sukkal ša3 giš-/kin-ti-da gen-na\n&#39;,
 &#39;o. 7     3 sila3 kaš 2 sila3 zi3\n&#39;,
 &#39;o. 8     1 i3 a2-GAM\n&#39;,
 &#39;o. 9     En-u2-mi-i3-li2\n&#39;,
 &#39;o. 10     ma2 giš-še3 gen-na\n&#39;,
 &#39;o. 11     3 sila3 kaš 2 sila3 zi3\n&#39;,
 &#39;r. 1     1 i3 a2-GAM\n&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-data-into-fields">
<h3>2.4.1.3.2 Split Data into Fields<a class="headerlink" href="#split-data-into-fields" title="Permalink to this headline">#</a></h3>
<p>Each data type (text ID, line number, comments, etc.) is made into a separate column of a data frame. Each row of that data frame represents one line in an Ur III document.</p>
<p>First, the code looks for lines that begin with 6 digits, for instance:</p>
<blockquote>
<div><p>038576	AAICAB 1/1, Ashm. 1911-146 = CDLI P142659</p>
</div></blockquote>
<p>Those numbers are the <a class="reference external" href="http://bdtns.filol.csic.es/">BDTNS</a> text ID numbers and mark the beginning of a new document. The numbers correspond to the <code class="docutils literal notranslate"><span class="pre">id_text</span></code> numbers in the catalog above. If such a line is found, the number is stored in the variable <code class="docutils literal notranslate"><span class="pre">bdtns_no</span></code>. Other data available in such lines (such as publication and <a class="reference external" href="http://cdli.ucla.edu">CDLI</a> P-number) are omitted, because they are better derived from the catalog file.</p>
<p>Other lines are transliteration lines that may have one or more of the following:</p>
<ul class="simple">
<li><p>line number in the format ‘o.ii 5’ (obverse column ii line 5)</p></li>
<li><p>transliteration</p></li>
<li><p>editorial remarks</p></li>
</ul>
<p>For instance:</p>
<blockquote>
<div><p>o. 4     — Lu2-Ib-gal dumu Ur-⌈x⌉-[…] # (1 nu-dib erased)</p>
</div></blockquote>
<p>Line numbers are separated from transliteration by five spaces. Editorial remarks (which may indicate the presence of a seal impression, an erased line, or provide an alternative reading) are introduced by the hash mark and are placed at the end of the line. A specific type of editorial remark is the sign name, which explains an x-value (see below section <a class="reference internal" href="#id2"><span class="std std-ref">2.4.1.4.1</span></a>), a rare sign form, or a rare sign reading. These particular editorial remarks have the form (=SIGN NAME), for instance:</p>
<blockquote>
<div><p>o. 2     gi ziX-a 12 sar-⌈ta⌉ (=SIG7)</p>
</div></blockquote>
<p>The script replaces the five spaces with a hash mark and ‘(=’ with ‘#(=’, so that we can use the hash mark to split the line in (potentially) three elements: line number, transliteration, and editorial comment. Both types of editorial comments (sign names and true comments) end up in the third column. We then prefix each line with the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> number that was isolated previously, and with a counter (<code class="docutils literal notranslate"><span class="pre">id_line</span></code>) that is set to zero for each new document. The field <code class="docutils literal notranslate"><span class="pre">id_line</span></code> is an integer that can be used to keep or to restore the proper order of the lines within a document.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">id_line</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">id_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">bdtns</span><span class="p">):</span> 
    <span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span> 
        <span class="n">id_text</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">id_line</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">id_line</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">li</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">li</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(=&quot;</span><span class="p">,</span> <span class="s2">&quot;#(=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;     &#39;</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">li_l</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># split line into a list with length 3.</span>
        <span class="n">li_l</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_text</span><span class="p">,</span> <span class="n">id_line</span><span class="p">]</span> <span class="o">+</span> <span class="n">li_l</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">li_l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7349d26ef9504f0ba3f8e17c8e3b056c", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="create-dataframe">
<h3>2.4.1.3.3 Create DataFrame<a class="headerlink" href="#create-dataframe" title="Permalink to this headline">#</a></h3>
<p>The list <code class="docutils literal notranslate"><span class="pre">lines</span></code> is now a list of lists which can be transformed into a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> DataFrame. The DataFrame will have <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (for ‘Not a Number’) in all cases where a field is empty. <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s are treated by Python as a numerical data type and will throw errors when trying to apply a string function. Therefore, all <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s are replaced by the empty string with the <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id_text&quot;</span><span class="p">,</span> <span class="s2">&quot;id_line&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;comments&quot;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span>  <span class="c1"># inspect the results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>id_line</th>
      <th>label</th>
      <th>text</th>
      <th>comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>203551</td>
      <td>1</td>
      <td>o. 1</td>
      <td>1 nu-dib Lugal-⌈x⌉ [...]</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>203551</td>
      <td>2</td>
      <td>o. 2</td>
      <td>1 nu-dib A-a-kal-la dum[u ...] / AN? [...]</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>203551</td>
      <td>3</td>
      <td>o. 3</td>
      <td>1 nu-dib Lu2-{d}Šara2 [dumu] / Lugal-{d}Iš[tar...</td>
      <td>(= K[A.DI?])</td>
    </tr>
    <tr>
      <th>3</th>
      <td>203551</td>
      <td>4</td>
      <td>o. 4</td>
      <td>--- Lu2-Ib-gal dumu Ur-⌈x⌉-[...]</td>
      <td>(1 nu-dib erased)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>203551</td>
      <td>5</td>
      <td>o. 5</td>
      <td>1 nu-dib Lu2-uru-bar-ra dumu ⌈Nam⌉-ha-ni / sagi</td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1162512</th>
      <td>191926</td>
      <td>7</td>
      <td>r.</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1162513</th>
      <td>191926</td>
      <td>8</td>
      <td>s. 1</td>
      <td>Lu2-{d}⌈Šul⌉-gi-r[a]</td>
      <td></td>
    </tr>
    <tr>
      <th>1162514</th>
      <td>191926</td>
      <td>9</td>
      <td>s. 2</td>
      <td>dub-sar</td>
      <td></td>
    </tr>
    <tr>
      <th>1162515</th>
      <td>191926</td>
      <td>10</td>
      <td>s. 3</td>
      <td>dumu Ur-{d}Šara2</td>
      <td></td>
    </tr>
    <tr>
      <th>1162516</th>
      <td>191926</td>
      <td>11</td>
      <td>s. 4</td>
      <td>GA2-dub-ba-k-[a]</td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>1162517 rows × 5 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="make-ogsl-compliant">
<h2>2.4.1.4 Make OGSL compliant<a class="headerlink" href="#make-ogsl-compliant" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="http://oracc.org/ogsl">OGSL</a> is the ORACC Global Sign List, which lists for each sign its possible readings. <a class="reference external" href="http://oracc.org/ogsl">OGSL</a> compliance opens the possibility to search or compare by sign <em>name</em> rather than sign value. For instance, one may search for the sequence “aga₃ kug-sig₁₇” (golden tiara) and find a line reading “gin₂ ku₃-GI”.</p>
<p>The main steps towards <a class="reference external" href="http://oracc.org/ogsl">OGSL</a> compliance are:</p>
<ul class="simple">
<li><p>add sign names to x-values</p></li>
<li><p>replace regular numbers by index numbers in sign values</p></li>
</ul>
<section id="dealing-with-x-values">
<span id="id2"></span><h3>2.4.1.4.1 Dealing with x-values<a class="headerlink" href="#dealing-with-x-values" title="Permalink to this headline">#</a></h3>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Molina, Manuel and Such-Gutiérrez, Marcos, On Terms for Cutting Plants and Noses in Ancient Sumer: <em>Journal of Near Eastern Studies</em> 63 (2004) 1-16</p>
</aside>
<p>A peculiarity of the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> data set is the way so-called x-values are represented. In Assyriology, x-values are sign readings that have not (yet) received a conventional index number. For instance, the (very common) word  for “to cut (reeds)” is written either with the sign <strong>zi</strong> or with the sign <strong>SIG₇</strong>. Based on the distribution of those spellings (<strong>SIG₇</strong> only in Umma, <strong>zi</strong> elsewhere), M. Molina and M. Such-Guttiérez (2004)[^2] concluded that both spellings write the same word /<strong>zi</strong>/. On that basis the new reading <strong>/zi/</strong> for the sign <strong>SIG₇</strong> was introduced (and is now commonly accepted among Sumerologists). In such cases one may transliterate <strong>ziₓ(SIG₇)</strong> where the SIG₇ between brackets is the name of the sign transliterated as <strong>ziₓ</strong> (and thus the principle of a one-to-one mapping of a transliterated token to a cuneiform sign is maintained). In the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> export file this is represented as follows:</p>
<blockquote>
<div><p>o. 2     gi ziX-a 12 sar-⌈ta⌉ (=SIG7)		cut reed per 12 <em>sar</em> of field</p>
</div></blockquote>
<p>The index ₓ is represented by a capital X (as in ziX), and the sign name is added at the end of the line, between parens and preceded by the equal sign.</p>
<p>In order to use this data for computational purposes (for instance computing sign frequencies) it is necessary to move the sign specification and to transform this into</p>
<blockquote>
<div><p>o. 2     gi ziₓ(SIG7)-a 12 sar-⌈ta⌉</p>
</div></blockquote>
<p>It is possible to do so with a script or regular expression, and to move the sign name to the position immediately after the capital X. Before we do so, it is useful to inspect some exceptions to the pattern. In some cases sign names are provided for rare readings, for instance:</p>
<blockquote>
<div><p>18 gin2 nagga mu-kuX gibil (=<a class="reference external" href="http://AN.NA">AN.NA</a>) (=DU)</p>
</div></blockquote>
<p>If we naively move the first sign name to the first X, we will get:</p>
<blockquote>
<div><p>18 gin2 nagga mu-kuX(<a class="reference external" href="http://AN.NA">AN.NA</a>) gibil  (=DU)</p>
</div></blockquote>
<p>(=<a class="reference external" href="http://AN.NA">AN.NA</a>), in this case, explains the rare reading <strong>nagga</strong> (tin, or some similar substance), whereas (=DU) explains <strong>kuX</strong> - but there is no obvious way for a regular expression or script to recognize that. Another type of exception is reduplicated “gurₓ-gurₓ” (to reap) which is represented thus:</p>
<blockquote>
<div><p>6.0.0 še ur5-ra še gurX-gurX-ta su-ga (=ŠE.KIN.ŠE.KIN)</p>
</div></blockquote>
<p>which, if we naively moved the sign name, would result in:</p>
<blockquote>
<div><p>6.0.0 še ur5-ra še gurₓ(ŠE.KIN.ŠE.KIN)-gurₓ-ta su-ga</p>
</div></blockquote>
<ul class="simple">
<li><p>x-values that are unambiguous are resolved with a search and replace, using a dictionary - replacing, e.g. ziX with ziₓ(IGI&#64;g). This process does not pay attention to the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> sign explication in the <code class="docutils literal notranslate"><span class="pre">comments</span></code> column (=SIG7). A special case in this category is mu-kuX (“delivery”), which is very frequent and should be resolved as mu-kuₓ(DU). However, kuX by itself may also be resolved as kuₓ(LIL) or kuₓ(KWU147) (both for the verb “to enter”).</p></li>
<li><p>x-values that do not resolve unambiguously (muruₓ, ušurₓ, ummuₓ, and several others) are resolved by moving the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> sign name (in the <code class="docutils literal notranslate"><span class="pre">comments</span></code> column) after the X sign between brackets, as discussed above.</p></li>
</ul>
<p>Both of these steps are included in the function <code class="docutils literal notranslate"><span class="pre">ogsl_v()</span></code>, that is applied to every row of the DataFrame. In addition, this function will replace index numbers (such as the 7 in sig7) with Unicode index numbers (sig₇), leaving alone numbers that represent quantities (<strong>7 sila3</strong> becomes <strong>7 sila3</strong>, not <strong>₇ sila₃</strong>).</p>
<p>For <code class="docutils literal notranslate"><span class="pre">ogsl_v()</span></code> to run properly and efficiently, a number of translation tables, dictionaries, and compiled <a class="reference external" href="https://www.regular-expressions.info/">regular expressions</a> are defined before the function is called.</p>
</section>
<section id="step-1-unambiguous-x-values">
<h3>2.4.1.4.2 Step 1: Unambiguous x-values<a class="headerlink" href="#step-1-unambiguous-x-values" title="Permalink to this headline">#</a></h3>
<p>Some x-values are always resolved in the same way. Thus, ziX is always ziₓ(IGI&#64;g), hirinX is always hirinₓ(KWU318), and gurX is always gurₓ(|ŠE.KIN|). In some cases, x-values have been assigned an index number in <a class="reference external" href="http://oracc.org/ogsl">OGSL</a>. In those cases (nigarₓ = nigar; nemurₓ(PIRIG.TUR) = nemur₂; nagₓ(GAZ) = nag₃; and pešₓ(ŠU.PEŠ5) = peš₁₄) the appropriate index number should be added and the sign name ignored.</p>
<p>A dictionary of such unambiguous x-values (<code class="docutils literal notranslate"><span class="pre">xvalues</span></code>) has as its key the x-value as represented in <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> in lower case (‘zix’) and as its value the index ₓ plus the appropriate sign name (‘ₓ(IGI&#64;g)’) in <a class="reference external" href="http://oracc.org/ogsl">OGSL</a> format.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">OGSL Sign Names</p>
<p><a class="reference external" href="http://oracc.org/ogsl">OGSL</a> uses a set of standard sign names. What is represented as SIG7 in <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> has the name IGI&#64;g in <a class="reference external" href="http://oracc.org/ogsl">OGSL</a>. In IGI&#64;g the element &#64;g is an abbreviation for the (Akkadian) word <em>gunû</em>, which was used by ancient scribal scholars to describe a sign with extra hatching. IGI: 𒅆; IGI&#64;g: 𒅊. Other such markers are &#64;t (<em>tenû</em>) for a slanted sign and &#64;š (<em>šeššig</em>) for a sign with additional wedges inscribed. The ‘times’ sign (×) is used to describe a sign that consists of a container sign, inscribed with another sign (as in |KA×GAR| 𒅥). In <a class="reference external" href="http://oracc.org/ogsl">OGSL</a> such compound signs are demarcated by pipes.</p>
</div>
<p>The substitution is done with a somewhat complex expression, that looks as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xvalues</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sub()</span></code> function of the <code class="docutils literal notranslate"><span class="pre">re</span></code> library has the general form <code class="docutils literal notranslate"><span class="pre">re.sub(search_pattern,</span> <span class="pre">replace,</span> <span class="pre">string)</span></code>. Instead of a replace string, one may also give a function (in this case a temporary <code class="docutils literal notranslate"><span class="pre">lambda</span></code> function) that returns the <code class="docutils literal notranslate"><span class="pre">replace</span></code> string. The <code class="docutils literal notranslate"><span class="pre">lambda</span></code> function queries the dictionary <code class="docutils literal notranslate"><span class="pre">xvalues</span></code> to see if the match that was found in the search pattern is present among the keys. The basic format of that command is <code class="docutils literal notranslate"><span class="pre">xvalues.get(m.group())</span></code>, where <code class="docutils literal notranslate"><span class="pre">m.group()</span></code> represents the current match of the search pattern. The search pattern, <code class="docutils literal notranslate"><span class="pre">xv</span></code> (to be explained in more detail below) may match <code class="docutils literal notranslate"><span class="pre">zahX</span></code>, <code class="docutils literal notranslate"><span class="pre">NigarX</span></code>, or <code class="docutils literal notranslate"><span class="pre">[bu]lugX</span></code> - in other words, the match may include capitals (as in <code class="docutils literal notranslate"><span class="pre">NigarX</span></code>) or brackets and flags (as in <code class="docutils literal notranslate"><span class="pre">[bu]lugX</span></code>). In order to find that match in the dictionary it is lowercased and “translated”. The function <code class="docutils literal notranslate"><span class="pre">translate()</span></code> translates individual characters into other characters - according to a translation pattern in a table. In this case, the characters representing flags and brackets are all translated to <code class="docutils literal notranslate"><span class="pre">None</span></code> which means, in practice, that they are removed. The matches <code class="docutils literal notranslate"><span class="pre">zahX</span></code>, <code class="docutils literal notranslate"><span class="pre">NigarX</span></code>, and <code class="docutils literal notranslate"><span class="pre">[bu]lugX</span></code>, therefore, will be looked up in the dictionary as <code class="docutils literal notranslate"><span class="pre">zahx</span></code>, <code class="docutils literal notranslate"><span class="pre">nigarx</span></code>, and <code class="docutils literal notranslate"><span class="pre">bulugx</span></code> - and each of those are indeed keys in <code class="docutils literal notranslate"><span class="pre">xvalues</span></code>. In the <code class="docutils literal notranslate"><span class="pre">get()</span></code> function one may optionally add a fall-back value in case the key is not found - in this case the fall-back is ‘X’.</p>
<p>If a match is found, say <code class="docutils literal notranslate"><span class="pre">[bu]lugX</span></code>, the key <code class="docutils literal notranslate"><span class="pre">bulugx</span></code> is found in the dictionary <code class="docutils literal notranslate"><span class="pre">xvalues</span></code>, returning <code class="docutils literal notranslate"><span class="pre">ₓ(|ŠIM×KUŠU₂|)</span></code>. The return value of the lambda function is the search match (<code class="docutils literal notranslate"><span class="pre">[bu]lugX</span></code>) minus the last character (<code class="docutils literal notranslate"><span class="pre">[bu]lug</span></code>) plus the value that was returned from the dictionary (<code class="docutils literal notranslate"><span class="pre">ₓ(|ŠIM×KUŠU₂|)</span></code>), resulting in <code class="docutils literal notranslate"><span class="pre">[bu]lugₓ(|ŠIM×KUŠU₂|)</span></code>. If the search pattern returns a match that is not found in the dictionary (for instance <code class="docutils literal notranslate"><span class="pre">ušurX</span></code>), the return value of the lambda function is, again, the search match (<code class="docutils literal notranslate"><span class="pre">ušurX</span></code>), minus the last character (<code class="docutils literal notranslate"><span class="pre">ušur</span></code>) plus <code class="docutils literal notranslate"><span class="pre">X</span></code>, the fallback return of the <code class="docutils literal notranslate"><span class="pre">get()</span></code> function, resulting in <code class="docutils literal notranslate"><span class="pre">ušurX</span></code>. In other words - in those cases the search match is replaced by itself and nothing changes.</p>
<p>The search pattern is a compiled regex (compiled expressions are faster than expressions that need to be interpreted on the fly), <code class="docutils literal notranslate"><span class="pre">xv</span></code>, which is defined as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xv</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\w&#39;</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]+X&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This matches any sequence of one or more (<code class="docutils literal notranslate"><span class="pre">+</span></code>) word-characters (<code class="docutils literal notranslate"><span class="pre">\w</span></code>; this includes letters from the English alphabet as well as special characters such as š, ṣ, and ṭ, the digits 0-9, and the underscore) and/or flags (such as square brackets etc.; see below: Flags), followed by a capital X. This regex will match <code class="docutils literal notranslate"><span class="pre">ziX</span></code>, <code class="docutils literal notranslate"><span class="pre">zahX</span></code>, or <code class="docutils literal notranslate"><span class="pre">ušurX</span></code>, but also <code class="docutils literal notranslate"><span class="pre">[za]hX</span></code>, etc. It does not match ‘KA×X’, ‘ X’, or ‘x-X’, because the characters × (for ‘times’) the hyphen and the space are neither word characters nor flags.</p>
<p>Special case: <strong>mu-kuX</strong>. There are multiple possible solutions for <strong>kuX</strong>, including kuₓ(LIL) or kuₓ(KWU147), but the very frequent form <strong>mu-kuX</strong> is always to be resolved <strong>mu-kuₓ(DU)</strong>. The regular expression <code class="docutils literal notranslate"><span class="pre">xv</span></code> in the preceding does not match hyphens and thus it will never find the key <code class="docutils literal notranslate"><span class="pre">mu-kuX</span></code> in the dictionary <code class="docutils literal notranslate"><span class="pre">xvalues</span></code>. However, this expression (meaning ‘delivery’) is so frequent that it makes sense to deal with it separately, rather than depend on the sign names in the <code class="docutils literal notranslate"><span class="pre">comments</span></code> column. The expression <strong>mu-kuX</strong> therefore, has its own line in the function.</p>
</section>
<section id="step-2-remaining-x-values">
<h3>2.4.1.4.3 Step 2: Remaining x-values<a class="headerlink" href="#step-2-remaining-x-values" title="Permalink to this headline">#</a></h3>
<p>For the remaining x-values (many of them ambiguous) we will copy the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> sign name, found in the <code class="docutils literal notranslate"><span class="pre">comments</span></code> column, to the x-value. For instance, <strong>ummu₃</strong> is |A.EDIN.LAL|, but the sign complex has many variants, all rendered <strong>ummuX</strong>: <a class="reference external" href="http://EDIN.A.SU">EDIN.A.SU</a>, A.EDIN, A.EDIN.A.LAL, EDIN, etc. The code will result in ummuₓ(|A.EDIN.SU|), ummuₓ(|A.EDIN|), ummuₓ(|A.EDIN.LAL|), ummuₓ(EDIN), etc. Compound signs are put between pipes (|A.EDIN.SU|), according to <a class="reference external" href="http://oracc.org/ogsl">OGSL</a> conventions.</p>
<p>In this step the code will naively replace the capital X by the index ₓ, followed by the first word in the <code class="docutils literal notranslate"><span class="pre">comments</span></code> column. This will result in errors if there are more such x-values in a single line - but because we have already dealt with many such values in the preceding, that risk is not very high. The code will test that the capital X does in fact follow a sign reading (as in ziX), and is not an illegible sign (as in KA×X, or simply X). This is done with a <a class="reference external" href="https://www.regular-expressions.info/">regular expression</a> using a so-called “positive lookbehind” (?&lt;=), to see if the preceding character is a letter. The regular expression for a capital ‘X’ preceded by any letter valid in Sumerian or Akkadian, is compiled in the variable <code class="docutils literal notranslate"><span class="pre">lettersX</span></code> in order to speed up the process (see below: Letters).</p>
</section>
<section id="step-3-index-numbers">
<h3>2.4.1.4.4 Step 3: Index Numbers<a class="headerlink" href="#step-3-index-numbers" title="Permalink to this headline">#</a></h3>
<p>In a third step all sign reading index numbers (as in ‘du11’) are replaced by Unicode index numbers (‘du₁₁’). Regular numbers that express quantities should not be affected. This is done with a regular expression that finds a character, valid in Sumerian or Akkadian transcription, immediately followed by one or more digits. If such a match is found, the string is translated, replacing any digit by its corresponding index number.</p>
</section>
<section id="errors">
<h3>2.4.1.4.5 Errors<a class="headerlink" href="#errors" title="Permalink to this headline">#</a></h3>
<p>Inevitably, each of the steps in dealing with x-values may introduce its own errors. It is likely, moreover, that there are more x-values not treated here, or that there will be more x-values in a future version of the <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> data. The dictionary of x-values below can be adjusted to deal with those situations.</p>
</section>
<section id="helpful-variables-lists-and-dictionaries">
<h3>2.4.1.4.6 Helpful Variables, Lists, and Dictionaries<a class="headerlink" href="#helpful-variables-lists-and-dictionaries" title="Permalink to this headline">#</a></h3>
<p>A number of lists, dictionaries, and variables (including compiled regular expressions) are defined before the main function is called.</p>
<p>The list <code class="docutils literal notranslate"><span class="pre">flags</span></code> enumerates characters like square brackets, half-brackets and exclamation marks that may appear in a sign reading in  in <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a>. The list is used in two ways. First, it is used in compiling the regular expression <code class="docutils literal notranslate"><span class="pre">xv</span></code> that will match any sign reading that ends in a capital X (see below). Second, it is used to create a table in which each flag corresponds to <code class="docutils literal notranslate"><span class="pre">None</span></code>. The <code class="docutils literal notranslate"><span class="pre">maketrans()</span></code> function is a specialized function that prepares a table that is understood by the <code class="docutils literal notranslate"><span class="pre">translate()</span></code> command. The command <code class="docutils literal notranslate"><span class="pre">translate(table)</span></code> is used in the function <code class="docutils literal notranslate"><span class="pre">ogsl_v()</span></code> (see below) to ignore any flag.</p>
<p>The <a class="reference external" href="https://www.regular-expressions.info/">regular expression</a> <code class="docutils literal notranslate"><span class="pre">xv</span></code> matches a sequence of one or more characters, immediately followed by a capital <code class="docutils literal notranslate"><span class="pre">X</span></code>. The characters allowed in the sequence are “word” characters (represented by <code class="docutils literal notranslate"><span class="pre">\w</span></code>), as well as the flags. Word characters are implemented slightly differently in different programs that use regular expressions. In Python it includes the English letters of the alphabet, as well as special characters such as ṭ, ṣ, and š, but also digits (0-9) and the underscore. The <code class="docutils literal notranslate"><span class="pre">escape()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">re</span></code> library supplies the proper escape character for characters in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> variable that otherwise have a special function in regular expressions. For instance, the question mark, which is included in the flags, means ‘zero or one time’ in a regular expression. In order to match the literal question mark it should be represented as <code class="docutils literal notranslate"><span class="pre">\?</span></code> - the <code class="docutils literal notranslate"><span class="pre">escape()</span></code> funcion takes care of that.</p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">letters</span></code> is a string that includes all letters that are valid in Sumerian or Akkadian, to be used in regular expressions. The variable <code class="docutils literal notranslate"><span class="pre">lettersX</span></code> is a compiled regular expression that represents a capital <code class="docutils literal notranslate"><span class="pre">X</span></code> preceded by any character in <code class="docutils literal notranslate"><span class="pre">letters</span></code>. The variable <code class="docutils literal notranslate"><span class="pre">lettersX</span></code>is a so-called look-behind expression so that the match consists only of the capital X. Similarly, the variable <code class="docutils literal notranslate"><span class="pre">lettersNo</span></code> is a compiled regular expression that represents a sequence of one or more digits (represented by <code class="docutils literal notranslate"><span class="pre">\d+</span></code>) or capital <code class="docutils literal notranslate"><span class="pre">X</span></code> preceded by any character in <code class="docutils literal notranslate"><span class="pre">letters</span></code>. The variable <code class="docutils literal notranslate"><span class="pre">lettersno</span></code>, however, does not use the lookbehind function (which is relatively slow) because the translation affects only the digits, other characters are left unchanged.</p>
<p>The dictionary <code class="docutils literal notranslate"><span class="pre">xvalues</span></code> provides the unambiguous x-values in <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> as keys with their resolution according to <a class="reference external" href="http://oracc.org/ogsl">OGSL</a> standards.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flags</span> <span class="o">=</span> <span class="s2">&quot;][!?&lt;&gt;⸢⸣⌈⌉*/&quot;</span>
<span class="n">table</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;[\w</span><span class="si">{</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span><span class="si">}</span><span class="s1">]+X&#39;</span><span class="p">)</span> <span class="c1">#this matches a sequence of word signs (letters) and/or flags, followed by capital X</span>

<span class="n">letters</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;a-zḫĝŋṣšṭA-ZḪĜŊṢŠṬ&#39;</span>
<span class="n">lettersX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;(?&lt;=[</span><span class="si">{</span><span class="n">letters</span><span class="si">}</span><span class="s1">])X&#39;</span><span class="p">)</span> <span class="c1"># capital X preceded by a letter</span>
<span class="n">lettersNo</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">letters</span><span class="si">}</span><span class="s1">](\d+|X)&#39;</span><span class="p">)</span> <span class="c1"># any sequence of digits, or X, preceded by a letter</span>

<span class="n">ascind</span><span class="p">,</span> <span class="n">uniind</span> <span class="o">=</span> <span class="s1">&#39;0123456789x&#39;</span><span class="p">,</span> <span class="s1">&#39;₀₁₂₃₄₅₆₇₈₉ₓ&#39;</span>
<span class="n">transind</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">ascind</span><span class="p">,</span> <span class="n">uniind</span><span class="p">)</span> <span class="c1"># translation table for index numbers</span>

<span class="n">xvalues</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nagx&#39;</span> <span class="p">:</span> <span class="s1">&#39;₃&#39;</span><span class="p">,</span> <span class="s1">&#39;nigarx&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;nemurx&#39;</span> <span class="p">:</span> <span class="s1">&#39;₂&#39;</span><span class="p">,</span> <span class="s1">&#39;pešx&#39;</span> <span class="p">:</span> <span class="s1">&#39;₁₄&#39;</span><span class="p">,</span> <span class="s1">&#39;urubx&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;tubax&#39;</span> <span class="p">:</span> <span class="s1">&#39;₄&#39;</span><span class="p">,</span> <span class="s1">&#39;niginx&#39;</span> <span class="p">:</span> <span class="s1">&#39;₈&#39;</span><span class="p">,</span> <span class="s1">&#39;šux&#39;</span> <span class="p">:</span> <span class="s1">&#39;₁₄&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;alx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|NUN.LAGAR|)&#39;</span> <span class="p">,</span> <span class="s1">&#39;bulugx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|ŠIM×KUŠU₂|)&#39;</span><span class="p">,</span> <span class="s1">&#39;dagx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(KWU844)&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;durux&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|IGI.DIB|)&#39;</span><span class="p">,</span> <span class="s1">&#39;durunx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|KU.KU)&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;gigirx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|LAGAB×MU|)&#39;</span><span class="p">,</span> <span class="s1">&#39;giparx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(KISAL)&#39;</span><span class="p">,</span> <span class="s1">&#39;girx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(GI)&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;gišbunx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|KI.BI|)&#39;</span><span class="p">,</span> <span class="s1">&#39;gurx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|ŠE.KIN|)&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;hirinx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(KWU318)&#39;</span><span class="p">,</span> <span class="s1">&#39;kurunx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|DIN.BI|)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mu-kux&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(DU)&#39;</span><span class="p">,</span> <span class="s1">&#39;munsubx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|PA.GU₂×NUN|)&#39;</span><span class="p">,</span>  
        <span class="s1">&#39;sagx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|ŠE.KIN|)&#39;</span><span class="p">,</span> <span class="s1">&#39;subx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|DU.DU|)&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;sullimx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(EN)&#39;</span><span class="p">,</span> <span class="s1">&#39;šaganx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|GA×AN.GAN|)&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ulušinx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|BI.ZIZ₂|)&#39;</span><span class="p">,</span> <span class="s1">&#39;zabalamx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|MUŠ₃.TE.AB@g|)&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;zahx&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(ŠEŠ)&#39;</span><span class="p">,</span> <span class="s1">&#39;zahdax&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(|DUN.NE.TUR|)&#39;</span><span class="p">,</span>  
        <span class="s1">&#39;zix&#39;</span> <span class="p">:</span> <span class="s1">&#39;ₓ(IGI@g)&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-main-function">
<h3>2.4.1.4.7 The Main Function<a class="headerlink" href="#the-main-function" title="Permalink to this headline">#</a></h3>
<p>The function <code class="docutils literal notranslate"><span class="pre">ogsl_v()</span></code> takes one row of the DataFrame at the time and goes through three separate steps, as discussed above (unambiguous x-values, other x-values, sign index numbers).</p>
<p>In each of these steps the function uses one or more of the tables, dictionaries, and compiled regular expressions created above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ogsl_v</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="c1"># 1. deal with unambiguous x-values, listed in the dictionary xvalues.</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xvalues</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;mu-kuX&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">table</span><span class="p">):</span> 
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">xvalues</span><span class="p">[</span><span class="s1">&#39;mu-kux&#39;</span><span class="p">])</span>
    <span class="c1"># 2. deal with remaining x-values</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;comments&quot;</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;(=&quot;</span><span class="p">:</span> 
        <span class="n">sign_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;comments&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">:]</span>  <span class="c1"># remove (=  from (=SIG7)</span>
        <span class="n">sign_name</span> <span class="o">=</span> <span class="n">sign_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#remove ) and anything following</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\.|×|\+&#39;</span><span class="p">,</span> <span class="n">sign_name</span><span class="p">):</span> <span class="c1"># if sign_name contains either . or × or +</span>
            <span class="n">sign_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ₓ(|</span><span class="si">{</span><span class="n">sign_name</span><span class="si">}</span><span class="s1">|)&#39;</span>  <span class="c1"># add pipes</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">sign_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ₓ(</span><span class="si">{</span><span class="n">sign_name</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="n">ogsl_valid</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">lettersX</span><span class="p">,</span> <span class="n">sign_name</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span> <span class="c1"># find sequence of letters followed by X; </span>
                                                              <span class="c1">#replace X by ₓ followed by sign name between brackets.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ogsl_valid</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>    
    <span class="c1"># 3 deal with index numbers</span>
    <span class="n">ogsl_valid</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">lettersNo</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">transind</span><span class="p">),</span> <span class="n">ogsl_valid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ogsl_valid</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="apply-the-function">
<h3>2.4.1.4.8 Apply the Function<a class="headerlink" href="#apply-the-function" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ogsl_v</span></code> function is now applied to each row (<code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>) in the DataFrame. Since the DataFrame currently has more than 1.1 million rows (lines) the function may take a few minutes and a progress bar from the <code class="docutils literal notranslate"><span class="pre">tqdm</span></code> library is added.</p>
<p>In the first cell of this notebook we initiated the use of tqdm with pandas with the line <code class="docutils literal notranslate"><span class="pre">tqdm.pandas()</span></code>. Instead of the regular <code class="docutils literal notranslate"><span class="pre">apply()</span></code> method from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library we may now use <code class="docutils literal notranslate"><span class="pre">progress_apply()</span></code> to do the same thing as <code class="docutils literal notranslate"><span class="pre">apply()</span></code>, but with a progress bar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="n">ogsl_v</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "962aae904a6845fe8406c3a843737905", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="check-for-remaining-x-signs">
<h3>2.4.1.4.9 Check for Remaining X-signs<a class="headerlink" href="#check-for-remaining-x-signs" title="Permalink to this headline">#</a></h3>
<p>Any remaining capital X should indicate an illegible sign - or else the script has run into an inconsistency. Such errors may be caused by</p>
<ul class="simple">
<li><p>square brackets occuring immediately before X (as in gari[g]X).</p></li>
<li><p>X-values that are not explained in the <code class="docutils literal notranslate"><span class="pre">comments</span></code> column.</p></li>
<li><p>other irregularities in transcription and/or comments.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id_text</th>
      <th>id_line</th>
      <th>label</th>
      <th>text</th>
      <th>comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1132</th>
      <td>038652</td>
      <td>31</td>
      <td>r. 15</td>
      <td>[sa₂]-⌈du₁₁⌉ {d}En-ki u₃ {d}Uš-KA×X?-limmu₂</td>
      <td></td>
    </tr>
    <tr>
      <th>1619</th>
      <td>038660</td>
      <td>25</td>
      <td>r. 12'</td>
      <td>KA×X? la₂?-la₂? ⌈ša₃⌉ bala-a</td>
      <td></td>
    </tr>
    <tr>
      <th>2926</th>
      <td>038727</td>
      <td>8</td>
      <td>o. 7'</td>
      <td>0.0.1 en-numX-Eš₄-tar₂</td>
      <td></td>
    </tr>
    <tr>
      <th>4040</th>
      <td>038754</td>
      <td>8</td>
      <td>r. 1</td>
      <td>giri₃ bad₃-HI×X dumu LAGAB-ba-⌈x⌉-gu₂</td>
      <td></td>
    </tr>
    <tr>
      <th>4211</th>
      <td>038763</td>
      <td>5</td>
      <td>o. 5</td>
      <td>[...]-{d}Nanna mu / ⌈lugal⌉ PU₃ KA×X ⌈x⌉ [...]</td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1151567</th>
      <td>005340</td>
      <td>33</td>
      <td>r. 5</td>
      <td>0.2.0 SU.GIŠ.UR₂×X</td>
      <td></td>
    </tr>
    <tr>
      <th>1155253</th>
      <td>034706</td>
      <td>9</td>
      <td>r. 1</td>
      <td>e₂ {d}Šara₂ ⌈KA×X⌉-[...]</td>
      <td></td>
    </tr>
    <tr>
      <th>1156868</th>
      <td>197289</td>
      <td>10</td>
      <td>r. 6</td>
      <td>[mu {d}X]-{d}Su[en ... mu]-hul</td>
      <td></td>
    </tr>
    <tr>
      <th>1161290</th>
      <td>029047</td>
      <td>6</td>
      <td>o.i 6</td>
      <td>2.0.0 gan₂ 10.0.0 gur a-ša₃ numun-KA×X</td>
      <td></td>
    </tr>
    <tr>
      <th>1161382</th>
      <td>029049</td>
      <td>13</td>
      <td>o.i 12</td>
      <td>1.1.0 lugal-AB×X{ki}-še₃</td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>305 rows × 5 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="save">
<h2>2.4.1.5 Save<a class="headerlink" href="#save" title="Permalink to this headline">#</a></h2>
<p>Finally, the newly created DataFrame with <a class="reference external" href="http://bdtns.filol.csic.es">BDTNS</a> data is saved in two ways. The <code class="docutils literal notranslate"><span class="pre">to_pickle()</span></code> function of the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library is used to created a pickle, a file that can be opened in a future session to recreate the DataFrame. Second, the DataFrame is saved in JSON format, a format that is more suitable for sharing with other researchers. Both files are saved in the <code class="docutils literal notranslate"><span class="pre">output</span></code> directory.</p>
<section id="pickle-for-future-use">
<span id="id3"></span><h3>2.4.1.5.1 Pickle for Future Use<a class="headerlink" href="#pickle-for-future-use" title="Permalink to this headline">#</a></h3>
<p>Pickle the DataFrame for future use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pickled</span> <span class="o">=</span> <span class="s2">&quot;output/bdtns.p&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">pickled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dump-in-json-format-for-distribution">
<h3>2.4.1.5.2 Dump in JSON Format for Distribution<a class="headerlink" href="#dump-in-json-format-for-distribution" title="Permalink to this headline">#</a></h3>
<p>And/or dump the DataFrame in <a class="reference external" href="https://www.json.org/">JSON</a> format to share the data with others.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json</span> <span class="o">=</span> <span class="s1">&#39;bdtns.json&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">json</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span> 
    <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">,</span> <span class="n">force_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./2_4_Data_Acquisition_BDTNS"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2_4_0_Data_Acquisition_BDTNS.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">2.4 BDTNS</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2_4_2_Build_Sign_Search.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2.4.2 Build Sign Search for BDTNS</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Niek Veldhuis<br/>
  
      &copy; Copyright 2021.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>